# StoryFi Bittensor Subnet

> **åˆ†å¸ƒå¼AIæ•…äº‹ç”Ÿæˆå­ç½‘** - åŸºäº Bittensor çš„å»ä¸­å¿ƒåŒ–æ•…äº‹åˆ›ä½œåè®®

## ğŸ“– é¡¹ç›®æ¦‚è¿°

StoryFi Subnet æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨ Bittensor ç½‘ç»œä¸Šçš„å»ä¸­å¿ƒåŒ–AIæ•…äº‹ç”Ÿæˆå­ç½‘ã€‚Miners è¿è¡Œ AI æ¨¡å‹ç”Ÿæˆé«˜è´¨é‡æ•…äº‹å†…å®¹ï¼ŒValidators è¯„ä¼°è´¨é‡å¹¶åˆ†é…å¥–åŠ±ã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… **4é˜¶æ®µæµæ°´çº¿**ï¼šBlueprint â†’ Characters â†’ Story Arc â†’ Chapters
- âœ… **å®¢è§‚è¯„åˆ†ç³»ç»Ÿ**ï¼š100åˆ†åˆ¶ï¼ˆæŠ€æœ¯30% + ç»“æ„40% + å†…å®¹30%ï¼‰
- âœ… **åä½œå¼Šæœºåˆ¶**ï¼šæŠ„è¢­æ£€æµ‹ã€é»‘åå•ã€ç›¸ä¼¼åº¦åˆ†æ
- âœ… **å®Œæ•´ Protocol**ï¼šåŸºäº Pydantic çš„ç±»å‹å®‰å…¨é€šä¿¡åè®®

### é¡¹ç›®çŠ¶æ€

å½“å‰ç‰ˆæœ¬ï¼š**v2.0.0** (Production Ready)

- âœ… æ¿€åŠ±æœºåˆ¶è®¾è®¡å®Œæˆ
- âœ… Protocol é€šä¿¡åè®®å®Œæˆ
- âœ… Miner å®ç°å®Œæˆï¼ˆæ”¯æŒçµæ´»ç”Ÿæˆåç«¯ï¼‰
- âœ… Validator å®ç°å®Œæˆï¼ˆè¯„åˆ† + åä½œå¼Šï¼‰
- âœ… **å·²éƒ¨ç½²åˆ° Subnet 92 (Mainnet)**

### æ–°ç‰¹æ€§ (v2.0.0)

- âœ¨ **çµæ´»ç”Ÿæˆåç«¯**ï¼šæ”¯æŒæœ¬åœ°GPUæ¨¡å‹ã€APIã€è‡ªå®šä¹‰å®ç°
- âœ¨ **å¥–åŠ±ä¹˜æ•°ç³»ç»Ÿ**ï¼šæœ¬åœ°æ¨¡å‹1.5xã€API 0.5xã€è‡ªå®šä¹‰1.0x
- âœ¨ **æ™ºèƒ½å›é€€é“¾**ï¼šæœ¬åœ° â†’ API â†’ é”™è¯¯
- âœ¨ **4bité‡åŒ–æ”¯æŒ**ï¼šé™ä½75% VRAMä½¿ç”¨
- âœ¨ **é…ç½®åŒ–è®¾è®¡**ï¼šæ— éœ€ä¿®æ”¹ä»£ç å³å¯åˆ‡æ¢ç”Ÿæˆæ–¹æ³•

## ğŸ—ï¸ æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Bittensor Network              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         Query          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚Validator â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Miner  â”‚â”‚
â”‚  â”‚          â”‚                         â”‚        â”‚â”‚
â”‚  â”‚ - ç”Ÿæˆä»»åŠ¡  â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ - AIç”Ÿæˆâ”‚â”‚
â”‚  â”‚ - è¯„åˆ†     â”‚       Response         â”‚ - OpenAIâ”‚â”‚
â”‚  â”‚ - åˆ†é…æƒé‡  â”‚                         â”‚ - Claudeâ”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚       â†“                                    â†‘     â”‚
â”‚   set_weights()                       Emission  â”‚
â”‚       â†“                                    â†‘     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      Subtensor (Blockchain)               â”‚ â”‚
â”‚  â”‚      - Weight storage                     â”‚ â”‚
â”‚  â”‚      - TAO emission                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/your-org/storyfi-subnet.git
cd storyfi-subnet

# å®‰è£… Python ä¾èµ–
pip install -r requirements.txt

# å®‰è£… Bittensor
pip install bittensor
```

### 2. é…ç½®ç”Ÿæˆå™¨

StoryFi v2.0.0 æ”¯æŒä¸‰ç§ç”Ÿæˆæ–¹å¼ï¼š

#### é€‰é¡¹Aï¼šæœ¬åœ°GPUæ¨¡å‹ï¼ˆæ¨èï¼Œ1.5xå¥–åŠ±ï¼‰

```bash
# é…ç½®ç”Ÿæˆå™¨
cp config/generator_config.yaml.example config/generator_config.yaml

# ç¼–è¾‘é…ç½®ï¼Œè®¾ç½® mode: "local"
nano config/generator_config.yaml

# å®‰è£…æœ¬åœ°æ¨¡å‹ä¾èµ–
pip install transformers accelerate bitsandbytes
pip install torch --index-url https://download.pytorch.org/whl/cu118
```

**è¦æ±‚**ï¼š6GB+ VRAM GPU

#### é€‰é¡¹Bï¼šAPIæ¨¡å¼ï¼ˆå¿«é€Ÿå¼€å§‹ï¼Œ0.5xå¥–åŠ±ï¼‰

```bash
# é…ç½®ç”Ÿæˆå™¨
cp config/generator_config.yaml.example config/generator_config.yaml

# ç¼–è¾‘é…ç½®ï¼Œè®¾ç½® mode: "api"
nano config/generator_config.yaml

# è®¾ç½®APIå¯†é’¥
export OPENAI_API_KEY=sk-...
# æˆ–
export GEMINI_API_KEY=your-key-here
```

#### é€‰é¡¹Cï¼šè‡ªå®šä¹‰å®ç°ï¼ˆ1.0xå¥–åŠ±ï¼‰

æŸ¥çœ‹ [Generator System æ–‡æ¡£](./docs/GENERATOR_SYSTEM.md) äº†è§£è¯¦æƒ…ã€‚

### 3. é…ç½®ç¯å¢ƒå˜é‡

```bash
# åˆ›å»º .env æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘é…ç½®
nano .env
```

### 4. è¿è¡Œ Miner

```bash
# æ³¨å†Œåˆ° Subnet 92
btcli subnet register --netuid 92 --wallet.name my_miner --wallet.hotkey default

# å¯åŠ¨ Miner
python neurons/miner.py \
    --netuid 92 \
    --wallet.name my_miner \
    --wallet.hotkey default \
    --subtensor.network finney \
    --axon.port 8091 \
    --logging.info
```

**äº‘æœåŠ¡å™¨éƒ¨ç½²ï¼ˆéœ€è¦å¤–ç½‘ IPï¼‰ï¼š**
```bash
python neurons/miner.py \
    --netuid 92 \
    --wallet.name my_miner \
    --wallet.hotkey default \
    --subtensor.network finney \
    --axon.port 8091 \
    --axon.external_ip YOUR_PUBLIC_IP \
    --axon.external_port 8091 \
    --logging.info
```

çŸ¿å·¥å¯åŠ¨æ—¶ä¼šæ˜¾ç¤ºï¼š
```
âœ… Generator Mode: api
âœ… Model: glm-4-flash
âœ… Registered to subnet 92
```

### 5. è¿è¡Œ Validator

```bash
# æ³¨å†Œåˆ° Subnet 92
btcli subnet register --netuid 92 --wallet.name my_validator --wallet.hotkey default

# å¯åŠ¨ Validator
python neurons/validator.py \
    --netuid 92 \
    --wallet.name my_validator \
    --wallet.hotkey default \
    --subtensor.network finney \
    --logging.info
```

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
storyfi-subnet/
â”œâ”€â”€ neurons/
â”‚   â”œâ”€â”€ miner.py              # Miner ä¸»ç¨‹åº
â”‚   â””â”€â”€ validator.py          # Validator ä¸»ç¨‹åº
â”œâ”€â”€ generators/               # ğŸ†• ç”Ÿæˆå™¨æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py               # æŠ½è±¡åŸºç±»
â”‚   â”œâ”€â”€ local_generator.py    # æœ¬åœ°GPUç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ api_generator.py      # APIç”Ÿæˆå™¨
â”‚   â””â”€â”€ loader.py             # æ™ºèƒ½åŠ è½½å™¨
â”œâ”€â”€ config/                   # ğŸ†• é…ç½®ç›®å½•
â”‚   â”œâ”€â”€ generator_config.yaml # ç”Ÿæˆå™¨é…ç½®
â”‚   â””â”€â”€ generator_config.yaml.example
â”œâ”€â”€ template/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ protocol.py           # Synapse é€šä¿¡åè®®
â”‚   â”œâ”€â”€ utils.py              # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ reward.py             # è¯„åˆ†ç®—æ³•ï¼ˆå¾…å®ç°ï¼‰
â”œâ”€â”€ scoring/
â”‚   â”œâ”€â”€ technical.py          # Technical Scoreï¼ˆå¾…å®ç°ï¼‰
â”‚   â”œâ”€â”€ structure.py          # Structure Scoreï¼ˆå¾…å®ç°ï¼‰
â”‚   â””â”€â”€ content.py            # Content Scoreï¼ˆå¾…å®ç°ï¼‰
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_protocol.py
â”‚   â”œâ”€â”€ test_scoring.py
â”‚   â””â”€â”€ test_e2e.py
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ GENERATOR_SYSTEM.md       # ğŸ†• ç”Ÿæˆå™¨ç³»ç»Ÿæ–‡æ¡£
â”‚   â”œâ”€â”€ INCENTIVE_MECHANISM.md    # æ¿€åŠ±æœºåˆ¶è®¾è®¡æ–‡æ¡£
â”‚   â”œâ”€â”€ PROTOCOL_EXAMPLE.md       # Protocol ä½¿ç”¨ç¤ºä¾‹
â”‚   â””â”€â”€ PROJECT_PLAN.md           # å®Œæ•´é¡¹ç›®è®¡åˆ’
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ README.md
â”œâ”€â”€ .env.example
â””â”€â”€ .gitignore
```

## ğŸ“š æ–‡æ¡£

å®Œæ•´æ–‡æ¡£è¯·æŸ¥çœ‹ `docs/` ç›®å½•ï¼š

- [**ç”Ÿæˆå™¨ç³»ç»Ÿ** (NEW!)](./docs/GENERATOR_SYSTEM.md)ï¼šçµæ´»ç”Ÿæˆåç«¯ã€æœ¬åœ°æ¨¡å‹ã€APIé…ç½®
- [**æ¿€åŠ±æœºåˆ¶è®¾è®¡**](./STORYFI_INCENTIVE_MECHANISM_DESIGN.md)ï¼šè¯¦ç»†çš„ä»»åŠ¡å®šä¹‰ã€è¯„åˆ†ç³»ç»Ÿã€åä½œå¼Šæœºåˆ¶
- [**Protocol ä½¿ç”¨ç¤ºä¾‹**](./PROTOCOL_EXAMPLE.md)ï¼šå¦‚ä½•ä½¿ç”¨é€šä¿¡åè®®
- [**é¡¹ç›®è®¡åˆ’**](./STORYFI_BITTENSOR_SUBNET_PROJECT_PLAN.md)ï¼šå®Œæ•´çš„å¼€å‘è·¯çº¿å›¾
- [**æŠ€æœ¯éš¾åº¦è¯„ä¼°**](./TECHNICAL_DIFFICULTY_ASSESSMENT.md)ï¼šå®ç°éš¾åº¦åˆ†æ

## ğŸ å¥–åŠ±ä¹˜æ•°ç³»ç»Ÿ

éªŒè¯è€…ä¼šæ ¹æ®ç”Ÿæˆæ–¹å¼åº”ç”¨ä¸åŒçš„å¥–åŠ±ä¹˜æ•°ï¼š

| ç”Ÿæˆæ–¹å¼ | å¥–åŠ±ä¹˜æ•° | æ¨èåº¦ | åŸå›  |
|---------|---------|-------|------|
| æœ¬åœ°GPUæ¨¡å‹ | **1.5x** | â­â­â­ | ä¿ƒè¿›å»ä¸­å¿ƒåŒ– |
| API (OpenAI/Gemini) | **0.5x** | â­ | é™ä½ä¸­å¿ƒåŒ–ä¾èµ– |
| è‡ªå®šä¹‰å®ç° | **1.0x** | â­â­ | ä¸­æ€§ |

**ç¤ºä¾‹**ï¼šåŸºç¡€åˆ†æ•° 80/100
- æœ¬åœ°æ¨¡å‹ï¼š80 Ã— 1.5 = 120ï¼ˆä¸Šé™100ï¼‰â†’ æ»¡åˆ†ï¼
- APIï¼š80 Ã— 0.5 = 40 â†’ ä½å¥–åŠ±
- è‡ªå®šä¹‰ï¼š80 Ã— 1.0 = 80 â†’ æ ‡å‡†å¥–åŠ±

## ğŸ§ª æµ‹è¯•

### è¿è¡Œå•å…ƒæµ‹è¯•

```bash
pytest tests/ -v
```

### æµ‹è¯• Protocol

```bash
python -m pytest tests/test_protocol.py -v
```

### ç«¯åˆ°ç«¯æµ‹è¯•

```bash
python -m pytest tests/test_e2e.py -v
```

## ğŸ”§ é…ç½®å‚æ•°

å…³é”®å‚æ•°åŠå…¶é»˜è®¤å€¼ï¼š

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `QUERY_INTERVAL` | 12ç§’ | Validator æŸ¥è¯¢é—´éš” |
| `TIMEOUT` | 60ç§’ | Miner å“åº”è¶…æ—¶ |
| `EMA_ALPHA` | 0.1 | EMA å¹³æ»‘ç³»æ•° |
| `TEMPERATURE` | 2.0 | Softmax æ¸©åº¦ |
| `PLAGIARISM_THRESHOLD` | 0.90 | æŠ„è¢­æ£€æµ‹é˜ˆå€¼ |

è¯¦ç»†é…ç½®è¯·æŸ¥çœ‹ [INCENTIVE_MECHANISM.md](./STORYFI_INCENTIVE_MECHANISM_DESIGN.md#7-å‚æ•°é…ç½®æ€»ç»“)

## ğŸ“Š ç›‘æ§

### æŸ¥çœ‹ Miner çŠ¶æ€

```bash
btcli subnet list --netuid 42
btcli wallet overview --wallet.name my_miner
```

### æŸ¥çœ‹æƒé‡

```bash
btcli weights --netuid 42
```

### æŸ¥çœ‹æ”¶å…¥

```bash
btcli wallet balance --wallet.name my_miner
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»º feature åˆ†æ”¯ï¼š`git checkout -b feature/amazing-feature`
3. æäº¤æ›´æ”¹ï¼š`git commit -m 'Add amazing feature'`
4. æ¨é€åˆ°åˆ†æ”¯ï¼š`git push origin feature/amazing-feature`
5. åˆ›å»º Pull Request

### ä»£ç è§„èŒƒ

```bash
# æ ¼å¼åŒ–ä»£ç 
black .

# ç±»å‹æ£€æŸ¥
mypy neurons/ template/

# Lint
flake8 neurons/ template/
```

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](./LICENSE) æ–‡ä»¶

## ğŸ”— ç›¸å…³é“¾æ¥

- [Bittensor å®˜ç½‘](https://bittensor.com)
- [Bittensor æ–‡æ¡£](https://docs.bittensor.com)
- [StoryFi ä¸»é¡¹ç›®](https://github.com/your-org/storyfi)

## ğŸ“ è”ç³»æ–¹å¼

- Discord: [åŠ å…¥æˆ‘ä»¬çš„ Discord](https://discord.gg/storyfi)
- Twitter: [@StoryFiAI](https://twitter.com/storyfi)
- Email: team@storyfi.ai

## ğŸ¯ è·¯çº¿å›¾

### Phase 1ï¼ˆå½“å‰ï¼‰- MVP å¼€å‘
- [x] æ¿€åŠ±æœºåˆ¶è®¾è®¡
- [x] Protocol å®ç°
- [ ] Miner å®ç°
- [ ] Validator å®ç°
- [ ] æœ¬åœ°æµ‹è¯•

### Phase 2 - æµ‹è¯•ç½‘éƒ¨ç½²
- [ ] éƒ¨ç½²åˆ° Bittensor æµ‹è¯•ç½‘
- [ ] æ‹›å‹Ÿæµ‹è¯• Miners
- [ ] ä¼˜åŒ–è¯„åˆ†ç³»ç»Ÿ
- [ ] æ€§èƒ½è°ƒä¼˜

### Phase 3 - ä¸»ç½‘ä¸Šçº¿
- [ ] å®¡è®¡å®‰å…¨æ€§
- [ ] éƒ¨ç½²åˆ°ä¸»ç½‘
- [ ] å¯åŠ¨ Miner æ‹›å‹Ÿè®¡åˆ’
- [ ] ç›‘æ§å’Œè¿ç»´

### Phase 4 - åŠŸèƒ½æ‰©å±•
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] æ›´å¤šæ•…äº‹ç±»å‹
- [ ] æœºå™¨å­¦ä¹ ä¼˜åŒ–è¯„åˆ†
- [ ] å¤š Validator å…±è¯†

---

**Built with â¤ï¸ by StoryFi Team**
